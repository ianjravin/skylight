<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- CSRF Token -->
    <meta name="csrf-token" content="OaqydaeZcSApGX98npM6M1hoT0ewfhR5KmnIJ3VX">
    <meta name="description" content="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer ut tortor rutrum massa efficitur tincidunt vel nec lacus. Curabitur porta aliquet diam, eu gravida neque lacinia in. Praesent eget orci id sem commodo aliquet.">
    <meta name="keywords" content="Crowdfunding, crowfund, Zaka, campaign" />
    <link rel="shortcut icon" href="images/favicon.png" />

	<title> Create a post -  Zaka | Investment Platform</title>

	<!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />

    <!-- Custom styles for this template -->
    <link href="css/main.css" rel="stylesheet">

    <!-- FONT Awesome CSS -->
    <link href="css/font-awesome.min.css" rel="stylesheet">

     <!-- IcoMoon CSS -->
    <link href="css/icomoon.css" rel="stylesheet">

    <!-- Ionicons -->
    <link href="css/ionicons.min.css" rel="stylesheet" type="text/css" />

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="js/ie-emulation-modes-warning.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>

    <!-- Google Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Montserrat:700' rel='stylesheet' type='text/css' />

    <!-- Sweet Alert -->
    <link href="css/sweetalert.css" rel="stylesheet" type="text/css" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
<![endif]-->

<script type="text/javascript">
// URL BASE
var URL_BASE = "https://zaka.co.ke";
// ReadMore
var ReadMore = "View more...";
var ReadLess = "View less...";
</script>
	<!-- Fonts -->
	<link href='//fonts.googleapis.com/css?family=Raleway:100,600' rel='stylesheet' type='text/css'>

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	<!-- Scripts -->
    <script>
    window.Laravel = { csrfToken: "OaqydaeZcSApGX98npM6M1hoT0ewfhR5KmnIJ3VX" };
</script>
<style media="screen">
	.inp{
		border-radius: 15px;
	}
</style>

</head>
<body>

	<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=833373956732438";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

	<div class="popout font-default"></div>
	<div class="wrap-loader">
		<i class="fa fa-cog fa-spin fa-3x fa-fw cog-loader"></i>
		<i class="fa fa-cog fa-spin fa-3x fa-fw cog-loader-small"></i>
	</div>
	<div class="navbar navbar-inverse navbar-px padding-top-10 padding-bottom-10">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">


            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>

          </button>
          <a class="navbar-brand navigateto" href="index.html">
          	<img src="images/logo.png" class="logo" />
          	</a>
        </div>
        <div class="navbar-collapse collapse">

        	<ul class="nav navbar-nav navbar-right">
          		<!-- </li> -->
		    </ul>

         </div>

     </div>
		 <a href="home.html" class="navigateto">
			 <i class="fa fa-arrow-left myicon-right"></i> <strong>Back to dashboard</strong>
			 </a>

 </div>

	<div class="jumbotron md index-header jumbotron_set jumbotron-cover">
		<div class="container wrap-jumbotron position-relative">
			<h2 class="title-site">Create Post</h2>
		</div>
	</div>

	<div class="container margin-bottom-40 padding-top-40" id="app">
		<div class="row">

			<!-- col-md-8 -->
			<div class="col-md-12">
				<div class="wrap-center center-block" >


					<!-- form start -->
					<form>

						<!-- <input type="hidden" name="_token" value="ebZI0rBmJOC7BK2LDRxiXDUdfVRjXRxGVxB63Fd9"> -->
						<div class="filer-input-dragDrop position-relative" id="draggable">
							<input type="file" accept="image/*" @change="onFileChanged">

							<!-- previewPhoto -->
							<div class="previewPhoto">

								<div class="btn btn-danger btn-sm btn-remove-photo" id="removePhoto">
									<img  v-if="url" :src="url" alt="">
									<i class="fa fa-trash myicon-right"></i> Delete
								</div>

							</div>
							<!-- previewPhoto -->

							<div class="filer-input-inner">
								<div class="filer-input-icon">
									<i class="fa fa-cloud-upload"></i>
								</div>
								<div class="filer-input-text">
									<h3 class="margin-bottom-10">Click to select an image</h3>
									<h3>The image must be greater than or equal to: 2MB - 800x400 </h3>
									<img  v-if="url" :src="url" alt="">
								</div>
							</div>
						</div>


						<!-- Start Form Group -->
						<div class="form-group">
							<label>Account Title</label>
							<input type="text" value="" class="form-control" placeholder="Money for Inventory" v-model="title">
						</div>
						<!-- /.form-group-->

						<!-- Start Form Group -->
						<div class="form-group">
							<label>Choose a category</label>
							<select class="form-control" v-model="category">
                      		<option value="">Select One</option>



                            <option value="Business">Business</option>

                            <option value="Short-term-loans">Short-term-loans</option>

                            <option value="Agriculture">Agriculture</option>



                            <option value="Education">Education</option>

                            <option value="Health">Health</option>

                            <option value="Women">Women</option>


                            <option value="Capital">Capital</option>


						                          </select>
						</div>
						<!-- /.form-group-->

						<div class="form-group">
							<label>Account Goal</label>
							<div class="input-group">
								<div class="input-group-addon addon-dollar">Ksh</div>
								<input type="number" min="1" class="form-control" id="onlyNumber" value="" placeholder="10000" v-model="goal">
							</div>
						</div>

						<!-- Start Form Group -->
						<div class="form-group">
							<label>Location</label>
							<input type="text" value=""  class="form-control" placeholder="Location" v-model="location">
						</div>
						<!-- /.form-group-->


						<div class="form-group">
							<label>About the account</label>
							<input type="text" value=""  class="form-control" placeholder="post" v-model="description">
						</div>

						<!-- Alert -->
						<div class="alert alert-danger display-none" id="dangerAlert">
							<ul class="list-unstyled" id="showErrors"></ul>
						</div>
						<!-- Alert -->

						<!-- <div class="box-footer"> -->
							<hr />
							<button @click="addPost" class="btn btn-block btn-lg  custom-rounded btn-primary inp" type="button"> <i v-if="loading" class="fa fa-spinner fa-spin"></i> Create post</button>
						<!-- </div> -->
						<!-- /.box-footer -->
					</form>


				</div>
				<!-- wrap-center -->
			</div>
			<!-- col-md-12-->

		</div>
		<!-- row -->
	</div>

	<!-- HERE -->
	<!-- container -->

	<!-- ***** Footer ***** -->
<footer class="footer-main">
	<div class="container">

		<div class="row">
			<div class="col-md-4">
				<a href="index.html" class="navigateto">
					<img src="images/logo.png" />
				</a>
				 <p class="margin-tp-xs">Zaka International is an SME investment company that aims to bridge short-term financing gap of small and medium sized enterprises in Kenya so that they attain scale to large businesses further contributing to wealth generation and employment creation in Kenya and beyond..</p>

				 <ul class="list-inline">

				 <li><a href="http://twitter.com/" class="ico-social"><i class="fa fa-twitter"></i></a></li>


				 <li><a href="https://www.facebook.com/" class="ico-social"><i class="fa fa-facebook"></i></a></li>


				 <li><a href="https://www.instagram.com/" class="ico-social"><i class="fa fa-instagram"></i></a></li>



				 <li><a href="https://plus.google.com/" class="ico-social"><i class="fa fa-google-plus"></i></a></li>
								 </ul >

			</div><!-- ./End col-md-* -->

		</div><!-- ./End Row -->
	</div><!-- ./End Container -->
</footer><!-- ***** Footer ***** -->

<footer class="subfooter">
<div class="container">
<div class="row">
			<div class="col-md-12 text-center padding-top-20">
				<p>&copy; Zaka | Investment Platform - 2018</p>
			</div><!-- ./End col-md-* -->
</div>
</div>
</footer>

<!-- REQUIRED JS SCRIPTS -->

<!-- jQuery 2.1.4 -->
<script src="plugins/jquery/jQuery-2.1.4.min.js" type="text/javascript"></script>
<!-- Bootstrap 3.3.2 JS -->
<script src="bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
<!-- FastClick -->
	<script src="plugins/fastclick.min.js" type="text/javascript"></script>
<!-- AdminLTE App -->
<script src="bootstrap/js/app.min.js" type="text/javascript"></script>

<script src="plugins/sweetalert/sweetalert.min.js" type="text/javascript"></script>

<script src="bootstrap/js/functions.js" type="text/javascript"></script>


<!-- Morris -->
<script src="js/raphael-min.js" type="text/javascript"></script>
<script src="js/morris.min.js" type="text/javascript"></script>


    <script src="https://cdn.rawgit.com/alertifyjs/alertify.js/v1.0.10/dist/js/alertify.js"></script>
</body>
<script src="https://unpkg.com/vue@2.0.3/dist/vue.js"></script>
<script src="https://unpkg.com/axios@0.12.0/dist/axios.min.js"></script>
<script src="https://unpkg.com/lodash@4.13.1/lodash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script>
<script src="https://unpkg.com/vue-router"></script>
<script>
var app = new Vue({
  el: "#app",
  data: {
    description: "",
    location: "",
    entId: "",
    goal: "",
    image: null,
    category: "",
    title: "",
    url: null,
    loading: false
  },
  methods: {
    onFileChanged: function(e) {
      this.image = event.target.files[0];
      this.url = URL.createObjectURL(this.image);
      console.log(this.url);
    },
    addPost: function() {
      if (
        this.description == "" ||
        this.location == "" ||
        this.category == "" ||
        this.title == "" ||
        this.goal == ""
      ) {
        alertify.error("Please fill in all the details");
        return;
      }
      this.loading = true;
      let queryString = decodeURIComponent(window.location.search);
      queryString = queryString.substring(1).split("&");
      let details = queryString[1].split("=");
      this.entId = decodeURI(details[1]);
      console.log(this.entId);
      const formData = new FormData();
      formData.append("function", "post");
      formData.append("fileToUpload", this.image);
      formData.append("id", this.entId);
      formData.append("title", this.title);
      formData.append("category", this.category);
      formData.append("goal", this.goal);
      formData.append("location", this.location);
      formData.append("description", this.description);
      console.log(this.image, this.image.name);

      axios
        .post(
          "https://zaka.ticketsoko.com/api/index.php?function=post",
          formData
        )
        .then(response => {
          if (response.data.message == "Posted Success") {
            alertify.alert("Posted successfully");
            setTimeout(() => {
              window.location.reload(true);
            }, 2000);

            this.loading = false;
            return;
          }
          console.log(response);
        })
        .catch(err => {
          console.log(err);
        });
    },
    createUrls: function() {
      let queryString = decodeURIComponent(window.location.search);
      queryString = queryString.substring(1).split("&");
      let details = queryString[0].split("=");
      this.names = decodeURI(details[1]);
      //console.log(this.name);
      var links = [...document.getElementsByClassName("navigateto")];
      links.forEach(element => {
        element.href += `?name=${this.names}`;
        console.log(element.href);
        //console.log("url", this.name)
      });
    }
  },
  created: function() {
    this.createUrls();
  }
});
</script>

</html>
