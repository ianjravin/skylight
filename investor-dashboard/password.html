<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- CSRF Token -->
    <meta name="csrf-token" content="OaqydaeZcSApGX98npM6M1hoT0ewfhR5KmnIJ3VX">
    <meta name="description" content="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer ut tortor rutrum massa efficitur tincidunt vel nec lacus. Curabitur porta aliquet diam, eu gravida neque lacinia in. Praesent eget orci id sem commodo aliquet.">
    <meta name="keywords" content="Crowdfunding, crowfund, fundme, campaign" />
    <link rel="shortcut icon" href="images/favicon.png" />

	<title> Account Settings -  Zaka | Investment Platform</title>

	<!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css" />

    <!-- Custom styles for this template -->
    <link href="css/main.css" rel="stylesheet">

    <!-- FONT Awesome CSS -->
    <link href="css/font-awesome.min.css" rel="stylesheet">

     <!-- IcoMoon CSS -->
    <link href="css/icomoon.css" rel="stylesheet">

    <!-- Ionicons -->
    <link href="css/ionicons.min.css" rel="stylesheet" type="text/css" />

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="js/ie-emulation-modes-warning.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>

    <!-- Google Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Montserrat:700' rel='stylesheet' type='text/css' />

    <!-- Sweet Alert -->
    <link href="css/sweetalert.css" rel="stylesheet" type="text/css" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
<![endif]-->

<script type="text/javascript">

    // URL BASE
    var URL_BASE = "https://ianjravin.github.io/zaka-dashboard/";
    // ReadMore
    var ReadMore = "View more...";
    var ReadLess = "View less...";

 </script>
	<!-- Fonts -->
	<link href='//fonts.googleapis.com/css?family=Raleway:100,600' rel='stylesheet' type='text/css'>

	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	<!-- Scripts -->
    <script>
        window.Laravel = {"csrfToken":"OaqydaeZcSApGX98npM6M1hoT0ewfhR5KmnIJ3VX"}    </script>

</head>
<body>

	<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=833373956732438";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
 <div id="app">
	<div class="popout font-default"></div>
	<div class="wrap-loader">
		<i class="fa fa-cog fa-spin fa-3x fa-fw cog-loader"></i>
		<i class="fa fa-cog fa-spin fa-3x fa-fw cog-loader-small"></i>
	</div>
	<div class="navbar navbar-inverse navbar-px padding-top-10 padding-bottom-10">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">


            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">
          	<img src="images/logo.png" class="logo" />
          	</a>
        </div><!-- navbar-header -->

        <div class="navbar-collapse collapse">

        	<ul class="nav navbar-nav navbar-right">

          		<li>
          			<a href="#search"  class="text-uppercase font-default">
        				<i class="glyphicon glyphicon-search"></i> <span class="title-dropdown font-default"><strong>Search</strong></span>
        				</a>
          		</li>
</ul>
        			<li class="dropdown">
			          <a href="javascript:void(0);" data-toggle="dropdown" class="userAvatar myprofile dropdown-toggle">
			          		<img :src="investorProfilePicture" alt="User" class="img-circle avatarUser" width="21" height="21" />
			          		<span class="title-dropdown font-default"><strong>My Profile</strong></span>
			          		<i class="ion-chevron-down margin-lft5"></i>
			          	</a>

			          <!-- DROPDOWN MENU -->
			          <ul class="dropdown-menu arrow-up nav-session" role="menu" aria-labelledby="dropdownMenu4">

	          		 	<li>
	          		 		<a href="#" class="text-overflow">
	          		 			<i class="icon-cogs myicon-right"></i> Zaka Admin</a>
	          		 			</li>



	          		 			<li>
	          		 			<a href="#" class="text-overflow">
	          		 				<i class="fa fa-cog myicon-right"></i> Account Settings
	          		 				</a>
	          		 			</li>

	          		 		<li>
	          		 			<a href="#" class="logout text-overflow">
	          		 				<i class="glyphicon glyphicon-log-out myicon-right"></i> Log out
	          		 			</a>
	          		 		</li>
	          		 	</ul><!-- DROPDOWN MENU -->
	          		</li>



					          </ul>

         </div><!--/.navbar-collapse -->
     </div>
		 <a href="index.html" class="navigateto">
			<i class="fa fa-arrow-left myicon-right"></i> <strong>Back to dashboard</strong>
			</a>
 </div>

<div id="search">
    <button type="button" class="close">Ã—</button>
    <form autocomplete="off" action="http://fundme.miguelvasquez.net/search" method="get">
        <input type="search" value="" name="q" id="btnItems" placeholder="Enter Search Query..." />
        <button type="submit" class="btn btn-lg no-shadow btn-trans custom-rounded btn_search"  id="btnSearch">Search</button>
    </form>
</div>

<div class="jumbotron md index-header jumbotron_set jumbotron-cover">
      <div class="container wrap-jumbotron position-relative">
        <h2 class="title-site">Password</h2>
      </div>
    </div>

<div class="container margin-bottom-40">

		<!-- Col MD -->
		<div class="col-md-8 margin-bottom-20">



		<!-- ***** FORM ***** -->
       <form>

          	<!-- <input type="hidden" name="_token" value="rnkbigi5IzerPrO5bzfEN2mnlpjUYndw3kEP1mJg"> -->

            <!-- ***** Form Group ***** -->
            <div class="form-group has-feedback">
            	<label class="font-default">Old password</label>
              <input type="password" class="form-control login-field custom-rounded" name="old_password" placeholder="Old password" title="Old password" autocomplete="off" v-model="oldpass">
             </div><!-- ***** Form Group ***** -->
             <div class="form-group has-feedback">
            	<label class="font-default">New password</label>
              <input type="password" class="form-control login-field custom-rounded" name="password" placeholder="New Password" title="New password" autocomplete="off" v-model="newpass">
         </div><!-- ***** Form Group ***** -->



         <!-- ***** Form Group ***** -->
            <div class="form-group has-feedback">
            	<label class="font-default"> Confirm new password</label>
              <input type="password" class="form-control login-field custom-rounded" name="password" placeholder="Confirm New Password" title="New password" autocomplete="off" v-model="confirm">
         </div><!-- ***** Form Group ***** -->


           <button type="button" id="buttonSubmit" @click="updatePassword" class="btn btn-block btn-lg btn-main custom-rounded"><span v-if="loading" class="spinner"><i class="fa fa-spinner fa-spin"></i></span>Save changes</button>
       </form><!-- ***** END FORM ***** -->

		</div><!-- /COL MD -->

		<div class="col-md-4">
			<ul class="nav nav-pills nav-stacked">
			<li class="margin-bottom-5">
				<!-- **** list-group-item **** -->
		  <a href="dormancy.html" class="list-group-item navigateto">
		  	<i class="fa fa-pencil myicon-right"></i> Account Settings
		  	</a> <!-- **** ./ list-group-item **** -->
			</li>

		  	<li class="margin-bottom-5">
		  		<!-- **** list-group-item **** -->
		  <a href="account.html" class="list-group-item navigateto">
		  	<i class="fa fa-user myicon-right"></i> Profile Settings
		  	</a> <!-- **** ./ list-group-item **** -->
		  	</li>

		  	<li class="margin-bottom-5">
		  		<!-- **** list-group-item **** -->
		  <a href="password.html" class="list-group-item active  navigateto">
		  	<i class="fa fa-lock myicon-right"></i> Password
		  	</a> <!-- **** ./ list-group-item **** -->
		  	</li>



		</ul>		</div>

 </div><!-- container --><br><br><br><br><br><br>

 <!-- container wrap-ui -->

 <!-- ***** Footer ***** -->
<footer class="footer-main">
 <div class="container">

	 <div class="row">
		 <div class="col-md-4">
			 <a href="index.html">
				 <img src="images/logo.png" />
			 </a>
				<p class="margin-tp-xs">Zaka International is an SME investment company that aims to bridge short-term financing gap of small and medium sized enterprises in Kenya so that they attain scale to large businesses further contributing to wealth generation and employment creation in Kenya and beyond..</p>

				<ul class="list-inline">

				<li><a href="http://twitter.com/" class="ico-social"><i class="fa fa-twitter"></i></a></li>


				<li><a href="https://www.facebook.com/" class="ico-social"><i class="fa fa-facebook"></i></a></li>


				<li><a href="https://www.instagram.com/" class="ico-social"><i class="fa fa-instagram"></i></a></li>



				<li><a href="https://plus.google.com/" class="ico-social"><i class="fa fa-google-plus"></i></a></li>
								</ul >

		 </div><!-- ./End col-md-* -->

	 </div><!-- ./End Row -->
 </div><!-- ./End Container -->
</footer><!-- ***** Footer ***** -->

<footer class="subfooter">
	<div class="container">
	<div class="row">
    			<div class="col-md-12 text-center padding-top-20">
    				<p>&copy; Zaka | Investment Platform - 2018</p>
    			</div><!-- ./End col-md-* -->
	</div>
</div>
</footer>
</div>

		<!-- Bootstrap core JavaScript
    ================================================== -->
    <script src="http://fundme.miguelvasquez.net/public/plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/jquery.easing.1.3.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/jquery-ui-1.10.3.custom.min.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/jquery.ui.touch-punch.min.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/bootstrap/js/bootstrap.min.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/jquery.autosize.min.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/jqueryTimeago.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/bootbox.min.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/count.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/functions.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/jquery.form.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/plugins/sweetalert/sweetalert.min.js"></script>
    <script src="http://fundme.miguelvasquez.net/public/js/holder.min.js"></script>
    <script src="https://cdn.rawgit.com/alertifyjs/alertify.js/v1.0.10/dist/js/alertify.js"></script> 

</body>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/axios@0.12.0/dist/axios.min.js"></script>
<script src="https://unpkg.com/lodash@4.13.1/lodash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script>
<!-- <script src="https://unpkg.com/vue-router"></script> -->
<script>
    var app = new Vue({
        el:'#app',
        data:{
            name: '',
            account: '',
            id: '',
            investorProfilePicture: '',
            oldpass: '',
            newpass: '', 
            confirm: '',
            loading: false
        },
        methods:{
     getInvestorDetail: function (){
      let queryString = decodeURIComponent(window.location.search);
      queryString = queryString.substring(1).split("&");
      let details = queryString[0].split("=");
      this.account =  decodeURI(details[1]);
     details = queryString[1].split("=");
     this.name =  decodeURI(details[1]);
     details = queryString[2].split("="); 
     this.id = decodeURI(details[1]);
      },
      getInvestorInformation: function(){
        axios.get(`https://ticketsoko.com/zaka/api/index.php?function=getInvestors&keyword=${this.id}`)
        .then((response) => {
            console.log()
            response.data.data.forEach(element => {
                this.investorProfilePicture = element.image
                console.log(element.image)
                
            });
            console.log("I am here",response)
            
        }).catch((err) => {
            console.log(err)
            
        });
    },
    updatePassword: function (){
        this.loading = true
        if (this.newpass == '' || this.oldpass == '' || this.confirm == '') {
            alertify.error("Password field can not be empty")
            this.loading = false
            return;
            
        }
        
        var formData = new FormData()
        formData.append('oldPassword',this.oldpass)
        formData.append('confirmPassword',this.confirm)
        formData.append('newPassword', this.newpass )

        axios.post(`https://ticketsoko.com/zaka/api/index.php?function=changepassword&keyword=${this.id}`, formData)
        .then((response) => {
            if (response.data.message == 'password updated') {
                alertify.success(response.data.message)
                setTimeout(() => {
                    this.oldpass = ''
                    this.newpass = ''
                    this.confirm = ''
                    this.loading = false
                    return;
                    
                }, 2000);
            }else{
                
                alertify.error("password was not updated")
                    this.oldpass = ''
                    this.newpass = ''
                    this.confirm = ''
                this.loading = false
                    
            }
            console.log(response)
            
        }).catch((err) => {
            console.log(err)
            
        });
        
    },
     createUrls: function () {
        var links = [...document.getElementsByClassName('navigateto')]
        links.forEach(element => {
            element.href += `?objects=${this.account}&names=${this.name}&id=${this.id}`
            console.log(element.href)            
        });
      },
     
        },
        beforeMount: function (){
           this.getInvestorDetail()
           this.getInvestorInformation()
        },
        mounted:function (){
        this.createUrls()
        }

    })

</script>
</html>
